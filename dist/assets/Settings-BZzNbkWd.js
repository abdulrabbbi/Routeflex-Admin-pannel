import{r as i,j as e,n as p}from"./index-DDFCQUB-.js";import{u as E,C as M,D as V}from"./index-CtE0lt8R.js";import{U as Y,a as P}from"./authService-BHg48wwY.js";import{g as C}from"./getImageUrl-z_uDr8Pb.js";import{g as U,s as L}from"./s3-cbPBZTLb.js";import{I as j}from"./index-CUEGGqui.js";import"./iconBase-BFTLMTgk.js";const J=()=>{const[g,h]=i.useState("profile"),[N,x]=i.useState(!1),u=JSON.parse(localStorage.getItem("user")||"{}"),[r,d]=i.useState({firstName:u.firstName||"",lastName:u.lastName||"",email:u.email||"",profilePicture:null}),[S,m]=i.useState(null),o=i.useRef(null),v=i.useMemo(()=>async s=>{try{if(!s){m(null);return}const n=String(s),l=/^https?:/i.test(n),f=l&&/amazonaws\.com/.test(n),a=!l&&!n.startsWith("/");if(f||a){const A=await U(L(n),300);m(A||null);return}m(C(n)||null)}catch{m(null)}},[]);i.useEffect(()=>{v(u?.profilePicture)},[u?.profilePicture]),i.useEffect(()=>()=>{o.current&&(URL.revokeObjectURL(o.current),o.current=null)},[]);const[t,b]=i.useState({currentPassword:"",newPassword:"",passwordConfirm:""}),[c,D]=i.useState({language:"english",theme:"light",twoFactor:!0}),k=async s=>{s.preventDefault(),x(!0);try{const n={firstName:r.firstName,lastName:r.lastName,email:r.email,profilePicture:r.profilePicture},l=await Y(n),f=l?.user||l?.data?.user||l?.data?.data?.user||l?.data,a={...u,...f||{}};try{localStorage.setItem("user",JSON.stringify(a))}catch{}p.success("Profile updated successfully!"),d({firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",profilePicture:null}),o.current&&(URL.revokeObjectURL(o.current),o.current=null),await v(a?.profilePicture||null)}catch(n){p.error(n?.response?.data?.message||"Profile update failed")}finally{x(!1)}},y=s=>{if(!s.target.files?.length)return;const n=s.target.files[0];d(f=>({...f,profilePicture:n})),o.current&&URL.revokeObjectURL(o.current);const l=URL.createObjectURL(n);o.current=l,m(l)},w=async s=>{s.preventDefault(),x(!0);try{if(t.newPassword!==t.passwordConfirm)throw new Error("Passwords do not match");await P({currentPassword:t.currentPassword,newPassword:t.newPassword,passwordConfirm:t.passwordConfirm}),p.success("Password updated successfully!"),b({currentPassword:"",newPassword:"",passwordConfirm:""})}catch(n){p.error(n?.response?.data?.message||"Password update failed")}finally{x(!1)}},R=()=>{p.success("Preferences saved successfully!")};return e.jsxDEV("div",{className:"min-h-screen bg-gray-50 py-6 px-4 sm:px-6 lg:px-8",children:e.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[e.jsxDEV("h1",{className:"text-2xl font-semibold text-[#1e1e38] mb-6",children:"Settings"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:180,columnNumber:9},void 0),e.jsxDEV("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[e.jsxDEV("div",{className:"p-6 border-b md:border-b-0 md:border-r border-gray-200",children:e.jsxDEV("nav",{className:"space-y-2",children:[{id:"profile",icon:E,label:"Profile"},{id:"security",icon:M,label:"Security"},{id:"preferences",icon:V,label:"Preferences"}].map(s=>e.jsxDEV("button",{onClick:()=>h(s.id),className:`flex items-center w-full px-4 py-2 text-sm font-medium rounded-lg ${g===s.id?"bg-[#f3f4f8] text-[#1e1e38]":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsxDEV(s.icon,{className:"h-5 w-5 mr-3"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:200,columnNumber:21},void 0),s.label]},s.id,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:191,columnNumber:19},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:185,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:184,columnNumber:13},void 0),e.jsxDEV("div",{className:"col-span-3 p-6",children:[g==="profile"&&e.jsxDEV("form",{onSubmit:k,className:"space-y-6",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"Profile Picture"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:212,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-1 flex items-center",children:[e.jsxDEV("img",{src:S||j.Avatar,alt:"Profile",className:"h-16 w-16 rounded-lg object-cover",onError:s=>{s.currentTarget.src=j.Avatar},loading:"lazy",decoding:"async"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:216,columnNumber:23},void 0),e.jsxDEV("label",{className:"ml-4 px-4 py-2 border border-[#22c55e] text-[#22c55e] rounded-lg hover:bg-[#22c55e] hover:text-white cursor-pointer",children:["Change",e.jsxDEV("input",{type:"file",accept:"image/*",className:"hidden",onChange:y},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:229,columnNumber:25},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:227,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:215,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:211,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"First Name"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:240,columnNumber:21},void 0),e.jsxDEV("input",{type:"text",className:"mt-1 block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:r.firstName,onChange:s=>d({...r,firstName:s.target.value}),required:!0},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:243,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:239,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"Last Name"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:258,columnNumber:21},void 0),e.jsxDEV("input",{type:"text",className:"mt-1 block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:r.lastName,onChange:s=>d({...r,lastName:s.target.value}),required:!0},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:261,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:257,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"Email Address"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:276,columnNumber:21},void 0),e.jsxDEV("input",{type:"email",className:"mt-1 block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:r.email,onChange:s=>d({...r,email:s.target.value}),required:!0},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:279,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:275,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex justify-end pt-6",children:e.jsxDEV("button",{type:"submit",disabled:N,className:"px-6 py-2 bg-[#22c55e] text-white rounded-lg hover:bg-[#1ea550] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#22c55e] disabled:opacity-70 disabled:cursor-not-allowed",children:N?"Saving...":"Save Changes"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:294,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:293,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:210,columnNumber:17},void 0),g==="security"&&e.jsxDEV("form",{onSubmit:w,className:"space-y-6",children:[e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"text-sm font-medium text-[#1e1e38]",children:"Change Password"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:308,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-4 space-y-4",children:[e.jsxDEV("input",{type:"password",placeholder:"Current Password",className:"block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:t.currentPassword,onChange:s=>b({...t,currentPassword:s.target.value}),required:!0,minLength:6},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:312,columnNumber:23},void 0),e.jsxDEV("input",{type:"password",placeholder:"New Password",className:"block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:t.newPassword,onChange:s=>b({...t,newPassword:s.target.value}),required:!0,minLength:6},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:326,columnNumber:23},void 0),e.jsxDEV("input",{type:"password",placeholder:"Confirm New Password",className:"block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:t.passwordConfirm,onChange:s=>b({...t,passwordConfirm:s.target.value}),required:!0,minLength:6},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:340,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:311,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:307,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"text-sm font-medium text-[#1e1e38]",children:"Two-Factor Authentication"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:359,columnNumber:23},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:362,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:358,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex h-6 items-center",children:e.jsxDEV("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-[#22c55e] focus:ring-[#22c55e]",checked:c.twoFactor,onChange:s=>D({...c,twoFactor:s.target.checked})},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:367,columnNumber:23},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:366,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:357,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex justify-end pt-6",children:e.jsxDEV("button",{type:"submit",disabled:N,className:"px-6 py-2 bg-[#22c55e] text-white rounded-lg hover:bg-[#1ea550] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#22c55e] disabled:opacity-70 disabled:cursor-not-allowed",children:N?"Updating...":"Update Password"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:382,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:381,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:306,columnNumber:17},void 0),g==="preferences"&&e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"Language"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:396,columnNumber:21},void 0),e.jsxDEV("select",{className:"mt-1 block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:c.language,onChange:s=>D({...c,language:s.target.value}),children:[e.jsxDEV("option",{value:"english",children:"English"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:409,columnNumber:23},void 0),e.jsxDEV("option",{value:"spanish",children:"Spanish"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:410,columnNumber:23},void 0),e.jsxDEV("option",{value:"french",children:"French"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:411,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:399,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:395,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"block text-sm font-medium text-[#1e1e38]",children:"Theme"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:416,columnNumber:21},void 0),e.jsxDEV("select",{className:"mt-1 block w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e] focus:border-transparent",value:c.theme,onChange:s=>D({...c,theme:s.target.value}),children:[e.jsxDEV("option",{value:"light",children:"Light"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:429,columnNumber:23},void 0),e.jsxDEV("option",{value:"dark",children:"Dark"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:430,columnNumber:23},void 0),e.jsxDEV("option",{value:"system",children:"System"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:431,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:419,columnNumber:21},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:415,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex justify-end pt-6",children:e.jsxDEV("button",{type:"button",onClick:R,className:"px-6 py-2 bg-[#22c55e] text-white rounded-lg hover:bg-[#1ea550] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#22c55e]",children:"Save Preferences"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:436,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:435,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:394,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:208,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:183,columnNumber:11},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:182,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:179,columnNumber:7},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/Settings.tsx",lineNumber:178,columnNumber:5},void 0)};export{J as default};
