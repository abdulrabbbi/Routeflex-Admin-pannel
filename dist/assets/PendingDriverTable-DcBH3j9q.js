import{r as t,n as o,j as e}from"./index-DDFCQUB-.js";import{A as k}from"./index-BxU1EsR_.js";import{f as V,h as Y,i as w}from"./deliveryService-DaazW6EG.js";import{g as S}from"./getImageUrl-z_uDr8Pb.js";import{s as _,g as C}from"./s3-cbPBZTLb.js";import{T as F}from"./Skeleton-D6hoDHFB.js";import{E as L}from"./EmptyStateRow-DnQyE9Zp.js";import{T as I}from"./TablePager-BKTiqDT3.js";import{A as U}from"./AvatarCell-CcUu114p.js";import"./iconBase-BFTLMTgk.js";const g=10,$=i=>i?new Date(i).toLocaleDateString("en-GB"):"—",O=(i,d=0,m=5)=>Math.max(d,Math.min(m,i)),Z=()=>{const[i,d]=t.useState([]),[m,f]=t.useState(1),[u,j]=t.useState(10),[x,h]=t.useState(1),[c,D]=t.useState(!1),[N,v]=t.useState(""),[y,P]=t.useState({}),b=t.useCallback(async()=>{D(!0),v("");try{const n=await V(m,u);d(n?.data?.users||[]),h(n?.totalPages||1)}catch(n){v("Failed to fetch pending drivers"),o.error(n?.response?.data?.message||"Failed to load pending drivers"),d([])}finally{D(!1)}},[m,u]);t.useEffect(()=>{b()},[b]),t.useEffect(()=>{let n=!1;const a=Array.from(new Set((i||[]).map(r=>r.profilePicture).filter(r=>typeof r=="string"&&r.length>0)));return Promise.all(a.map(async r=>{try{const s=_(r),l=await C(s,300);return{original:r,url:l}}catch{return null}})).then(r=>{if(n)return;const s={};for(const l of r)l&&(s[l.original]=l.url);Object.keys(s).length&&P(s)}),()=>{n=!0}},[i]);const A=async n=>{const a=o.loading("Approving driver...");try{await Y(n),o.success("Driver approved"),d(r=>r.filter(s=>s._id!==n))}catch(r){o.error(r?.response?.data?.message||"Approval failed")}finally{o.dismiss(a)}},R=async n=>{const a=window.prompt("Reason for rejection (optional):")||void 0,r=o.loading("Rejecting driver...");try{await w(n,a),o.success("Driver rejected"),d(s=>s.filter(l=>l._id!==n))}catch(s){o.error(s?.response?.data?.message||"Rejection failed")}finally{o.dismiss(r)}},M=t.useMemo(()=>{if(c)return[];const n=Math.max(g-i.length,0);return[...i,...Array.from({length:n}).map(()=>({}))]},[i,c]);return e.jsxDEV("div",{className:"p-6",children:[e.jsxDEV("h2",{className:"text-xl font-bold mb-4 text-gray-900",children:"Pending Drivers"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:128,columnNumber:7},void 0),e.jsxDEV("div",{className:"overflow-x-auto w-full bg-white rounded-2xl border shadow-sm",children:[e.jsxDEV("table",{className:"min-w-[860px] w-full text-sm border-collapse",children:[e.jsxDEV("thead",{children:e.jsxDEV("tr",{className:"bg-[#f0fdf4] text-[#22c55e] text-xs uppercase",children:[e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Profile"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:134,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Name"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:135,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Email"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:136,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Phone"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:137,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Joined"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:138,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Rating"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:139,columnNumber:15},void 0),e.jsxDEV("th",{className:"px-3 py-3 text-center",children:"Actions"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:140,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:133,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:132,columnNumber:11},void 0),c?e.jsxDEV(F,{rows:g,columns:7},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:145,columnNumber:13},void 0):N?e.jsxDEV("tbody",{children:e.jsxDEV("tr",{children:e.jsxDEV("td",{colSpan:7,className:"px-4 py-12 text-center text-red-600",children:N},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:149,columnNumber:17},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:148,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:147,columnNumber:13},void 0):i.length===0?e.jsxDEV("tbody",{children:e.jsxDEV("tr",{children:e.jsxDEV("td",{colSpan:7,className:"py-16",children:e.jsxDEV("div",{className:"flex items-center justify-center",children:e.jsxDEV(L,{colSpan:7,title:"No Pending Drivers Found",hint:"Try changing filters or refreshing."},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:159,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:158,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:157,columnNumber:17},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:156,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:155,columnNumber:13},void 0):e.jsxDEV("tbody",{className:"divide-y divide-gray-100",children:M.map((n,a)=>{if(!n||!n._id)return e.jsxDEV("tr",{children:Array.from({length:7}).map((T,p)=>e.jsxDEV("td",{className:"px-3 py-4",children:e.jsxDEV("div",{className:"h-4 w-24 bg-gray-50 rounded"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:176,columnNumber:27},void 0)},p,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:175,columnNumber:25},void 0))},`pad-${a}`,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:173,columnNumber:21},void 0);const r=`${n.firstName??""} ${n.lastName??""}`.trim()||"-",s=y[n.profilePicture||""]||S(n.profilePicture||""),l=O(Number(n.rating||0)),E=$(n.createdAt);return e.jsxDEV("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsxDEV("td",{className:"px-3 py-3",children:e.jsxDEV(U,{fullName:r,src:s,size:40},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:192,columnNumber:23},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:191,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 text-gray-800",children:r},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:194,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 text-gray-800",children:n.email||"—"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:195,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 text-gray-800",children:n.phone||"—"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:196,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 text-gray-700",children:E},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:197,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 text-gray-800",children:l>0?e.jsxDEV("div",{className:"flex justify-center gap-1 text-yellow-400",children:Array.from({length:l},(T,p)=>e.jsxDEV(k,{},p,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:202,columnNumber:29},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:200,columnNumber:25},void 0):e.jsxDEV("span",{className:"text-gray-400 italic",children:"Not rated yet"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:206,columnNumber:25},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:198,columnNumber:21},void 0),e.jsxDEV("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsxDEV("div",{className:"flex justify-center gap-2",children:[e.jsxDEV("button",{onClick:()=>A(n._id),className:"h-8 w-8 flex items-center justify-center rounded-full bg-green-100 text-green-600 hover:bg-green-200",title:"Approve",children:"✓"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:211,columnNumber:25},void 0),e.jsxDEV("button",{onClick:()=>R(n._id),className:"h-8 w-8 flex items-center justify-center rounded-full bg-red-100 text-red-600 hover:bg-red-200",title:"Reject",children:"✕"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:218,columnNumber:25},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:210,columnNumber:23},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:209,columnNumber:21},void 0)]},n._id,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:190,columnNumber:19},void 0)})},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:169,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:131,columnNumber:9},void 0),e.jsxDEV("div",{className:"px-4 py-3 flex flex-col sm:flex-row items-center justify-between gap-3 border-t text-xs text-gray-500",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("label",{className:"text-sm text-gray-600",children:"Rows:"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:236,columnNumber:13},void 0),e.jsxDEV("select",{value:u,onChange:n=>j(Number(n.target.value)),className:"border rounded-lg px-2 py-1.5 text-sm",children:[10,20,50].map(n=>e.jsxDEV("option",{value:n,children:[n," / page"]},n,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:243,columnNumber:17},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:237,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:235,columnNumber:11},void 0),e.jsxDEV(I,{page:m,totalPages:x,onPrev:()=>f(n=>Math.max(1,n-1)),onNext:()=>f(n=>Math.min(x,n+1)),disabled:c},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:250,columnNumber:11},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:234,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:130,columnNumber:7},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/PendingDriverTable.tsx",lineNumber:127,columnNumber:5},void 0)};export{Z as default};
