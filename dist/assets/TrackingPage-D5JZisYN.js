import{r,j as e,n as w,R as $,d as U,L as O,b as _}from"./index-DDFCQUB-.js";import{G as K}from"./GoogleTrackingMap-2klPXzHZ.js";import{w as L,a as H,b as z}from"./index-CtE0lt8R.js";import{b as B}from"./index-9YfgzfWE.js";import{F as G}from"./index-ByTCOamh.js";import{A as W}from"./index-BxU1EsR_.js";import{b as J,c as q,r as P}from"./deliveryService-DaazW6EG.js";import{T as Q}from"./TablePager-BKTiqDT3.js";import{A as X}from"./AvatarCell-CcUu114p.js";import{g as Z}from"./getImageUrl-z_uDr8Pb.js";import{s as ee,g as ne}from"./s3-cbPBZTLb.js";import"./leaflet-DHXD0kNQ.js";import"./index-CUEGGqui.js";import"./iconBase-BFTLMTgk.js";const re=({driverId:p,setDriverId:d,driverData:m,onTrackDriver:g})=>{const[k,D]=r.useState(!1),[A,v]=r.useState(null),h=async()=>{try{D(!0),v(null),await g(),w.success("Driver tracking updated!")}catch(b){console.error(b),v("Failed to track driver. Please check the Driver ID."),w.error("Failed to track driver")}finally{D(!1)}};return e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-[#1e1e38]",children:"Driver Tracking"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:58,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex gap-4",children:[e.jsxDEV("input",{type:"text",placeholder:"Driver id....",value:p,onChange:b=>d(b.target.value.trim()),className:"flex-1 px-4 py-2 bg-gray-100 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#22c55e]"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:62,columnNumber:11},void 0),e.jsxDEV("button",{onClick:h,disabled:k,className:"w-[30%] py-3 bg-[#22c55e] text-white rounded-lg hover:bg-[#1ea550] transition-colors font-medium disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center",children:[k&&e.jsxDEV("span",{className:"loader mr-2"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:74,columnNumber:30},void 0),k?"Tracking...":"Track Driver"]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:69,columnNumber:11},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:61,columnNumber:9},void 0),A&&e.jsxDEV("div",{className:"text-red-500 text-sm mt-2",children:A},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:78,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:57,columnNumber:7},void 0),m&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxDEV("div",{className:"bg-[#23CD6D08] p-4 rounded-xl",children:e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV("div",{className:"p-2 bg-[#22c55e] bg-opacity-10 rounded-lg",children:e.jsxDEV(L,{className:"w-5 h-5 text-[#22c55e]"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:87,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:86,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Current Location"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:90,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentLocation},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:93,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:89,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:85,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:84,columnNumber:13},void 0),e.jsxDEV("div",{className:"bg-[#23CD6D08] p-4 rounded-xl",children:e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV("div",{className:"p-2 bg-[#22c55e] bg-opacity-10 rounded-lg",children:e.jsxDEV(H,{className:"w-5 h-5 text-[#22c55e]"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:103,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:102,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Current Task"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:106,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentTask},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:109,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:105,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:101,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:100,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:83,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxDEV("div",{className:"bg-white p-4 rounded-xl shadow",children:e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"p-2 bg-[#23CD6D]  rounded-lg",children:e.jsxDEV(B,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:119,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:118,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-2xl font-semibold text-[#1e1e38]",children:m.totalOrders},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:122,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-sm text-gray-500",children:"Total Orders"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:121,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:117,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:116,columnNumber:13},void 0),e.jsxDEV("div",{className:"bg-white p-4 rounded-xl shadow",children:e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"p-2 bg-[#23CD6D] rounded-lg",children:e.jsxDEV(z,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:133,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:132,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-2xl font-semibold text-[#1e1e38]",children:m.doneDeliveries},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:136,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-sm text-gray-500",children:"Done Deliveries"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:139,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:135,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:131,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:130,columnNumber:13},void 0),e.jsxDEV("div",{className:"bg-white p-4 rounded-xl shadow",children:e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"p-2 bg-[#23CD6D] rounded-lg",children:e.jsxDEV(L,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:147,columnNumber:19},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:146,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-2xl font-semibold text-[#1e1e38]",children:m.stopsLeft},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:150,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-sm text-gray-500",children:"Stops left"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:153,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:149,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:145,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:144,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:115,columnNumber:11},void 0),e.jsxDEV("div",{className:"bg-white p-6 rounded-xl shadow",children:[e.jsxDEV("h3",{className:"text-lg font-semibold text-[#1e1e38] mb-4",children:"Current Task Details"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:160,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Pickup Location"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:165,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentTaskDetails.pickup.location},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:168,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:164,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Pickup Time"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:173,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentTaskDetails.pickup.time},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:176,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:172,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Delivery Location"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:181,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentTaskDetails.delivery.location},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:184,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:180,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"text-sm text-[#22c55e] font-medium",children:"Delivery around"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:189,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-[#1e1e38]",children:m.currentTaskDetails.delivery.time},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:192,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:188,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:163,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:159,columnNumber:11},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:82,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/DriverTracking.tsx",lineNumber:56,columnNumber:5},void 0)},C=p=>p?new Date(p).toLocaleDateString("en-GB"):"-",se=(p,d=0,m=5)=>Math.max(d,Math.min(m,p)),I=new Map,te=()=>e.jsxDEV("tr",{className:"animate-pulse",children:Array.from({length:7}).map((p,d)=>e.jsxDEV("td",{className:"px-4 py-4",children:e.jsxDEV("div",{className:"h-4 rounded bg-gray-200 w-full"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:47,columnNumber:9},void 0)},d,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:46,columnNumber:7},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:44,columnNumber:3},void 0),ie=$.memo(()=>{const p=U(),[d,m]=r.useState([]),[g,k]=r.useState(1),[D,A]=r.useState(10),[v,h]=r.useState(1),[b,j]=r.useState(!1),[M,f]=r.useState(""),[R,Y]=r.useState({}),y=r.useCallback(async(n,u,x)=>{j(!0),f("");try{const t=await J(u,n);m(t?.data?.users??[]),h(Number(t?.totalPages??1)),k(t?.page??n)}catch(t){if(t?.name==="CanceledError"||t?.name==="AbortError")return;m([]),h(1),f("Failed to fetch drivers"),w.error(t?.response?.data?.message||"Failed to fetch drivers")}finally{j(!1)}},[]);r.useEffect(()=>{const n=new AbortController;return y(g,D,n.signal),()=>n.abort()},[y,g,D]),r.useEffect(()=>{let n=!1;const u=Array.from(new Set((d||[]).map(i=>i.profilePicture).filter(i=>typeof i=="string"&&i.length>0))),x=i=>{const a=/^https?:/i.test(i),o=a&&/amazonaws\.com/.test(i),c=!a&&!i.startsWith("/");return o||c},t=u.filter(i=>x(i)).map(async i=>{const a=ee(i),o=I.get(a);if(o)return{original:i,url:o};try{const c=await ne(a,300);return n?null:(I.set(a,c),{original:i,url:c})}catch{return null}});return Promise.all(t).then(i=>{if(n)return;const a={};for(const o of i)o&&o.url&&(a[o.original]=o.url);Object.keys(a).length&&Y(o=>({...o,...a}))}),()=>{n=!0}},[d]);const T=r.useCallback(()=>{k(n=>Math.max(1,n-1))},[]),s=r.useCallback(()=>{k(n=>Math.min(v||1,n+1))},[v]),l=r.useCallback(()=>{try{const n=["Driver ID","Full Name","Email","Phone","Verified","Joining Date"],u=d.map(c=>{const E=(c._id||"").slice(-6).toUpperCase(),S=`${c.firstName??""} ${c.lastName??""}`.trim()||"-",V=c.isVerified?"Yes":"No",F=C(c.createdAt);return[E,S,c.email||"-",c.phone||"-",V,F]}),x=[n,...u].map(c=>c.map(E=>{const V=String(E??"").replace(/"/g,'""');return/[",\n]/.test(V)?`"${V}"`:V}).join(",")).join(`
`),t=new Blob(["\uFEFF"+x],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(t),a=document.createElement("a"),o=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");a.href=i,a.download=`drivers-page${g}-${o}.csv`,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(i)}catch{w.error("Export failed")}},[d,g]),N=r.useMemo(()=>b?e.jsxDEV(e.Fragment,{children:Array.from({length:6}).map((n,u)=>e.jsxDEV(te,{},u,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:204,columnNumber:13},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:202,columnNumber:9},void 0):M?e.jsxDEV("tr",{children:e.jsxDEV("td",{colSpan:7,className:"px-4 py-6 text-center text-red-600",children:M},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:213,columnNumber:11},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:212,columnNumber:9},void 0):d.length?d.map(n=>{const u=n._id?.slice(-6).toUpperCase()||"-",x=`${n.firstName??""} ${n.lastName??""}`.trim()||"-",t=C(n.createdAt),i=(()=>{const o=n.profilePicture||"";if(!o)return;const c=R[o];if(c)return c;const E=/^https?:/i.test(o);if(!(E&&/amazonaws\.com/.test(o))&&!(!E&&!o.startsWith("/")))return Z(o)})(),a=se(Number(n.rating||0));return e.jsxDEV("tr",{className:"hover:bg-gray-50",children:[e.jsxDEV("td",{className:"px-4 py-4 text-center whitespace-nowrap",children:e.jsxDEV("div",{className:"flex items-center justify-center gap-3",children:[e.jsxDEV(X,{fullName:x,src:i,size:40},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:259,columnNumber:15},void 0),e.jsxDEV("span",{className:"hidden md:inline text-sm text-[#1e1e38]",children:x},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:261,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:258,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:257,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center text-[#1e1e38]",children:e.jsxDEV(O,{to:`driver/${n._id}/profile/overview`,children:u},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:268,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:267,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center text-[#1e1e38] md:hidden",children:x},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:274,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center text-[#1e1e38] hidden md:table-cell",children:x},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:277,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center",children:a>0?e.jsxDEV("div",{className:"flex justify-center items-center gap-1 text-yellow-400",children:Array.from({length:a},(o,c)=>e.jsxDEV(W,{},c,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:285,columnNumber:19},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:283,columnNumber:15},void 0):e.jsxDEV("span",{className:"text-gray-400 italic",children:"Not rated yet"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:289,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:281,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center",children:e.jsxDEV("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n.isVerified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:n.isVerified?"Verified":"Not Verified"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:294,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:293,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center text-[#1e1e38]",children:t},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:304,columnNumber:11},void 0),e.jsxDEV("td",{className:"px-4 py-4 text-sm text-center",children:e.jsxDEV("button",{onClick:()=>p(`/tracking/driver/${n._id}/profile/overview`),className:"p-2 rounded-lg hover:bg-gray-100","aria-label":"View driver details",children:e.jsxDEV(G,{className:"text-[#22c55e] w-5 h-5"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:314,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:309,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:308,columnNumber:11},void 0)]},n._id,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:255,columnNumber:9},void 0)}):e.jsxDEV("tr",{children:e.jsxDEV("td",{colSpan:7,className:"px-4 py-6 text-center text-gray-500",children:"No drivers found"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:223,columnNumber:11},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:222,columnNumber:9},void 0),[d,M,b,p]);return e.jsxDEV("div",{className:"p-6",children:[e.jsxDEV("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[e.jsxDEV("h2",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"Drivers"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:326,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("label",{className:"text-sm text-gray-600",children:"Rows:"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:331,columnNumber:13},void 0),e.jsxDEV("select",{value:D,onChange:n=>A(Number(n.target.value)),className:"border rounded-lg px-2 py-1 text-sm",children:[10,20,50].map(n=>e.jsxDEV("option",{value:n,children:n},n,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:338,columnNumber:17},void 0))},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:332,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:330,columnNumber:11},void 0),e.jsxDEV("button",{onClick:l,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border bg-white hover:bg-gray-50 text-sm font-medium",children:"⬇️ Export (.csv)"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:346,columnNumber:11},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:328,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:325,columnNumber:7},void 0),e.jsxDEV("div",{className:"bg-white rounded-2xl border shadow-sm overflow-hidden",children:[e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsxDEV("thead",{children:e.jsxDEV("tr",{className:"bg-[#f0fdf4]",children:[e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Profile"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:361,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Driver ID"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:364,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Full Name"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:367,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Rating"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:370,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Verified"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:373,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Created At"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:376,columnNumber:17},void 0),e.jsxDEV("th",{className:"px-4 py-3 text-xs text-[#22c55e] uppercase text-center",children:"Actions"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:379,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:360,columnNumber:15},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:359,columnNumber:13},void 0),e.jsxDEV("tbody",{className:"divide-y divide-gray-200",children:N},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:384,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:358,columnNumber:11},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:357,columnNumber:9},void 0),e.jsxDEV("div",{className:"px-4 py-4",children:e.jsxDEV("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxDEV(Q,{page:g,totalPages:v,onPrev:T,onNext:s,disabled:b},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:391,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-xs text-gray-500",children:["Showing ",e.jsxDEV("strong",{children:d.length},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:399,columnNumber:23},void 0)," item(s)",D?` • Limit ${D}`:""]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:398,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:390,columnNumber:11},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:389,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:356,columnNumber:7},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/components/drivers/DriversTable.tsx",lineNumber:323,columnNumber:5},void 0)}),ge=()=>{const[p,d]=r.useState(""),[m,g]=r.useState(null),[k,D]=r.useState([]),[A,v]=r.useState(null),[h,b]=r.useState(null),[j,M]=r.useState({}),f=_(),R=r.useRef(null),Y=r.useMemo(()=>p.trim().toUpperCase(),[p]),y=r.useCallback(async()=>{const T=Y;if(T)try{R.current=null,D([]);const s=await q(T),l=await P(s.currentLocation.coordinates[1],s.currentLocation.coordinates[0]);g({currentLocation:l,currentTask:s.currentTask,totalOrders:s.totalOrders,doneDeliveries:s.doneDeliveries,stopsLeft:s.stopsLeft,currentTaskDetails:{pickup:{location:s.currentTaskDetails?.pickupLocation||"N/A",time:s.currentTaskDetails?.pickupTime||"N/A"},delivery:{location:s.currentTaskDetails?.deliveryLocation||"N/A",time:s.currentTaskDetails?.deliveryTime||"N/A"}}}),D([[s.currentLocation.coordinates[1],s.currentLocation.coordinates[0]]]),v({lat:s.currentLocation.coordinates[1],lng:s.currentLocation.coordinates[0],address:l}),f&&f.emit("tracking:subscribe",{driverTrackingId:T},N=>{N?.ok&&N.latest?.driverId?b(N.latest.driverId):f&&f.emit("tracking:latest",{driverTrackingId:T},n=>{n?.ok&&n.latest?.driverId&&b(n.latest.driverId)})})}catch(s){console.error("Failed to fetch driver tracking",s)}},[Y,f]);return r.useEffect(()=>{if(!f)return;const T=l=>{const N=l?.coordinates||l?.location?.coordinates||l?.currentLocation?.coordinates||l?.coords;if(Array.isArray(N)&&N.length===2)return N},s=async l=>{if(!h||l?.driverId&&l.driverId!==h)return;const N=T(l);if(!N)return;const[n,u]=N,x=l?.at&&new Date(l.at).toISOString()||`${u},${n}`;if(R.current!==x){R.current=x,D(t=>[...t,[u,n]]),v(t=>({lat:u,lng:n,address:t?.address||"Updating..."})),M({speedKph:typeof l?.speedKph=="number"?l.speedKph:void 0,headingDeg:typeof l?.headingDeg=="number"?l.headingDeg:void 0,at:x});try{const t=await P(u,n);v({lat:u,lng:n,address:t})}catch{v(t=>({lat:u,lng:n,address:t?.address||"Unknown"}))}}};return f.on("tracking:update",s),f.on("location:driver",s),()=>{f.off("tracking:update",s),f.off("location:driver",s)}},[f,h]),e.jsxDEV("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxDEV("div",{className:"max-w-7xl mx-auto space-y-6",children:[A&&e.jsxDEV("div",{className:"relative rounded-2xl overflow-hidden shadow-lg h-[70vh]",children:[e.jsxDEV(K,{route:k,currentLocation:A},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:149,columnNumber:15},void 0),e.jsxDEV("div",{className:"absolute bottom-4 left-4 flex flex-wrap gap-3 z-[999]",children:[e.jsxDEV("div",{className:"bg-white/90 backdrop-blur-sm p-3 rounded-xl shadow shadow-green-900 text-center min-w-[120px]",children:[e.jsxDEV("div",{className:"text-xs text-gray-500",children:"Speed"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:157,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-lg font-semibold text-[#1e1e38]",children:j.speedKph?`${j.speedKph} km/h`:"—"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:158,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:156,columnNumber:15},void 0),e.jsxDEV("div",{className:"bg-white/90 backdrop-blur-sm p-3 rounded-xl shadow shadow-green-900 text-center min-w-[120px]",children:[e.jsxDEV("div",{className:"text-xs text-gray-500",children:"Heading"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:164,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-lg font-semibold text-[#1e1e38]",children:j.headingDeg?`${j.headingDeg}°`:"—"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:165,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:163,columnNumber:15},void 0),e.jsxDEV("div",{className:"bg-white/90 backdrop-blur-sm p-3 rounded-xl shadow shadow-green-900 text-center min-w-[120px]",children:[e.jsxDEV("div",{className:"text-xs text-gray-500",children:"Last Update"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:171,columnNumber:17},void 0),e.jsxDEV("div",{className:"text-lg font-semibold text-[#1e1e38]",children:j.at?new Date(j.at).toLocaleTimeString():"—"},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:172,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:170,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:155,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:147,columnNumber:11},void 0),e.jsxDEV(re,{driverId:p,setDriverId:d,driverData:m,onTrackDriver:y},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:181,columnNumber:9},void 0),e.jsxDEV(ie,{},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:187,columnNumber:9},void 0)]},void 0,!0,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:144,columnNumber:7},void 0)},void 0,!1,{fileName:"D:/Desktop/MY projects/Routeflex-Admin-pannel/src/pages/TrackingPage.tsx",lineNumber:143,columnNumber:5},void 0)};export{ge as default};
